(function(a,c){var b=function(d){if(d&&typeof d=="object"){for(var e in d){b.Config[e]=d[e]}}};b.Config={isVertical:true,isBGMovable:false,appsPerRow:4,appsPerColumn:4};b.extend=function(g){var g=arguments[0];if(typeof g!="object"&&typeof g!="function"){g={}}for(var f=1;f<arguments.length;f++){var e=arguments[f];if(typeof e=="object"){for(var d in e){g[d]=e[d]}}}return g};Array.prototype.require=b.require=function(g){var h=toString.call(this),j=[];if(typeof g=="string"){j.push(g)}if(h.indexOf("Array")!=-1){for(var f in this){if(typeof this[f]=="string"){j.push(this[f])}}}for(f=0;f<j.length;f++){var e=j[f];if(e.slice(-3).toLowerCase()!==".js"){e+=".js"}var d=document.createElement("script");d.src=e;d.type="text/javascript";document.head.appendChild(d)}};a._Base_=b;["./js/Ajax","./js/Debug","./js/DOM","./js/Browser","./js/System","./js/Drive","./js/Page","./js/App","./js/Sidebar","./js/Box","./js/Queue","./js/Widget","./js/Tray","./js/Notify","./js/Helper","./js/Sound","./js/spriteMovie","./js/Test"].require()})(window);!function(a){a.Ajax=a.extend(a.Ajax,{config:{type:"GET",isAsy:true,contentType:"application/x-www-form-urlencoded"},setConfig:function(c,b,d){if(typeof c=="string"){a.Ajax.config.type=c}if(typeof d=="string"){a.Ajax.config.contentType=d}if(typeof b=="boolean"){a.Ajax.config.isAsy=b}else{if(typeof b=="string"){if(b=="true"){a.Ajax.config.isAsy=true}else{if(b=="false"){a.Ajax.config.isAsy=false}}}}return this},ajax:function(b,d,e){var c=new XMLHttpRequest();if(this.config.type.toUpperCase()=="POST"){c.open(this.config.type,b,this.config.isAsy);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(d)}else{b=encodeURI(b+"?"+d);c.open(this.config.type,b,this.config.isAsy);c.send()}c.onreadystatechange=function(){if(c.status==200){try{if(c.responseXML){this.getResponseXML(c.responseXML);if(typeof e=="function"){e(c.responseXML)}}else{if(c.responseText){this.getResponseStr(c.responseText);if(typeof e=="function"){e(c.responseText)}}else{throw"The server response with no valuable entity."}}}catch(f){debug.log(f)}}}.bind(a.Ajax)},getResponseStr:function(b){console.log(b)},getResponseXML:function(b){console.log(b.getElementsByTagName("*")[0].nodeValue)},get:function(d,f,g,b){var e=new XMLHttpRequest(),c;if(typeof b=="boolean"){c=b}else{c=true}d=encodeURI(d+"?"+f);e.open("GET",d,c);e.send();e.onreadystatechange=function(){if(e.status==200){try{if(e.responseXML){this.getResponseXML(e.responseXML);if(typeof g=="function"){g(e.responseXML)}}else{if(e.responseText){this.getResponseStr(e.responseText);if(typeof g=="function"){g(e.responseText)}}else{throw"The server response with no valuable entity."}}}catch(h){debug.log(h)}}}.bind(a.Ajax)},post:function(d,g,h,b){var e=new XMLHttpRequest(),c;if(typeof b=="boolean"){c=b}else{c=true}var f="";if(typeof g=="object"){f=JSON.stringify(g)}else{if(typeof g=="string"){f=g}}e.open("POST",d,c);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send(f);e.onreadystatechange=function(){if(e.status==200){try{if(e.responseXML){this.getResponseXML(e.responseXML);if(typeof h=="function"){h(e.responseXML)}}else{if(e.responseText){this.getResponseStr(e.responseText);if(typeof h=="function"){h(e.responseText)}}else{throw"The server response with no valuable entity."}}}catch(i){debug.log(i)}}}.bind(a.Ajax)}});_Base_=a}(_Base_);!function(a){a.App=a.extend(a.App,{appStyle:null,iconWidth:0,iconHeight:0,getSize:function(){if(a.App.iconWidth&&a.App.iconHeight){return false}var b=document.getElementById("appScreen");if(b.clientWidth&&b.clientHeight){a.App.iconWidth=b.clientWidth/4;a.App.iconHeight=b.clientHeight/4}return true},register:function(c){a.App.appsCount++;var b=a.App.createAppNode(c);if(c.widget){a.require(c.widget);b.setAttribute("hasWidget","true")}a.Queue.queue.push(b)},createAppNode:function(g){var e;if(a.App.appStyle&&typeof a.App.appStyle=="function"){e=a.App.appStyle()}else{e=document.createElement("div");e.className="icon";e.id=g.packageName;var d=document.createElement("div");d.style.position="absolute";d.style.display="none";d.style.width="10px";d.style.height="10px";d.style.marginTop="-4px";d.style.marginLeft="-4px";d.style.zIndex="2";d.style.background="url(./images/close.png) top left no-repeat";d.style.backgroundSize="100% 100%";e.appendChild(d);var c=document.createElement("img");c.src=g.imgSrc;e.appendChild(c);var f=document.createElement("span");f.innerHTML=g.title;e.appendChild(f);var b=document.createElement("div");b.style.position="absolute";b.style.display="none";b.style.width="20px";b.style.height="20px";b.style.bottom="0";b.style.right="0";b.style.marginTop="4px";b.style.marginLeft="4px";b.style.zIndex="10";b.style.background="url(./images/enlarge.png) top left no-repeat";b.style.backgroundPosition="right bottom";e.appendChild(b)}return e},updateAppStyle:function(b){if(b&&typeof b=="function"){a.App.appStyle=b;return true}else{return false}},resizeApp:function(b,c){if(b){b.style.left=(c%a.Config.appsPerRow)*(100/a.Config.appsPerRow)+"%";b.style.top=Math.floor(c/a.Config.appsPerColumn)*100/(a.Page.pagesCount*a.Config.appsPerColumn)+"%";b.style.height=80/(a.Page.pagesCount*a.Config.appsPerColumn)+"%"}},shake:function(b){b.style.webkitTransformOrigin="50% 50%";b.style.webkitAnimationDuration="150ms";b.style.webkitAnimationName="shake";b.style.webkitAnimationIterationCount="2";setTimeout(function(){b.style.webkitTransformOrigin="";b.style.webkitAnimationDuration="";b.style.webkitAnimationName="";b.style.webkitAnimationIterationCount=""},5000)}});a.App=a.extend(a.App,{appsCount:0,Yield:function(b,c,d){if(c&&b>0){if(c.width==2&&c.height==2){return a.App.Yield.block22(b,c,d)}else{if(c.width==4&&c.height==1){return a.App.Yield.block14(b,c,d)}else{if(c.width==3&&c.height==1){return a.App.Yield.block13(b,c,d)}}}}}});a.App.Yield=a.extend(a.App.Yield,{block22:function(d,f,g){var e=d%a.Config.appsPerRow,c=false;var h="";h+=a.App.Yield.checkAround(d+4);h+=a.App.Yield.checkAround(d+5);h+=a.App.Yield.checkAround(d+1);h+=a.App.Yield.checkAround(d-3);h+=a.App.Yield.checkAround(d-4);h+=a.App.Yield.checkAround(d-5);h+=a.App.Yield.checkAround(d-1);h+=a.App.Yield.checkAround(d+3);h+=h[0];console.log(h);if(h.substr(2,3)==="000"){if(e!=0){a.Queue.switchQueue(d,d-4);d-=4;a.Debug.log("right top blank");c=true}}else{if(h.substr(4,3)==="000"){if(e!=1){a.Queue.switchQueue(d,d-5);d-=5;a.Debug.log("left top blank");c=true}}else{if(!(h.substr(6,3).match(/2/ig))&&!(h.substr(0,3).match(/2/ig))){if((h.substr(0,3)+"0").match(/0/ig).length<(h.substr(6,3)+"0").match(/0/ig).length){if(e==1){a.Queue.switchQueue(d,d+1);d+=1}a.Debug.log("left down blank");a.Queue.switchQueue(d,d-1);d-=1;a.App.Yield.down(d,f)}else{if(e==0){a.Queue.switchQueue(d,d-1);d-=1}a.Debug.log("right down blank");a.App.Yield.down(d,f)}c=true}else{if(!(h.substr(6,3).match(/2/ig))&&(h.substr(0,3).match(/2/ig))){if(e!=1){a.Queue.switchQueue(d,d-1);d-=1;a.Debug.log("left down blank");a.App.Yield.down(d,f);c=true}}else{if((h.substr(6,3).match(/2/ig))&&!(h.substr(0,3).match(/2/ig))){if(e!=0){a.Debug.log("right down blank");a.App.Yield.down(d,f);c=true}}}}}}var b=Math.ceil(a.Queue.queue.length/(a.Config.appsPerRow*a.Config.appsPerColumn));if(b>a.Page.pagesCount){a.Page.addPage(1)}return c},block14:function(){},block13:function(){},checkAround:function(b){console.log(b);if(b<1){return"2"}if(a.Widget.isWidget(b)){return"2"}else{if(a.Queue.queue[b-1]){return"1"}else{return"0"}}},down:function(m,f){console.log(m);var n,e=0;var l,h={},b;if(m%a.Config.appsPerRow==0){a.Queue.switchQueue(m,m-1);m-=1}for(var g=0;g<f.width;g++){if(!g){n=f.height-1;l=m+a.Config.appsPerRow;while(e<n){if(!a.Queue.queue[l-1]){e++;for(var c=0;c<f.height;c++){for(var d=0;d<f.width;d++){b=l-d-c*a.Config.appsPerRow;if(a.Queue.queue[b-1]&&a.Widget.widgets[a.Queue.queue[b-1].id]&&a.Widget.widgets[a.Queue.queue[b-1].id].widget.style.display=="block"){h[a.Queue.queue[b-1].id]=b;break}}}}l+=a.Config.appsPerRow}e=0;l-=a.Config.appsPerRow;while(l>m){if(a.Queue.queue[l-1]){if(h[a.Queue.queue[l-1].id]){h[a.Queue.queue[l-1].id]+=e*a.Config.appsPerRow}a.Queue.switchQueue(l,l+e*a.Config.appsPerRow)}else{e++}l-=a.Config.appsPerRow}}else{l=m+g;n=f.height;while(e<n){if(!a.Queue.queue[l-1]){e++;for(var c=0;c<f.height;c++){for(var d=0;d<f.width;d++){b=l-d-c*a.Config.appsPerRow;if(a.Queue.queue[b-1]&&a.Widget.widgets[a.Queue.queue[b-1].id]&&a.Widget.widgets[a.Queue.queue[b-1].id].widget.style.display=="block"){h[a.Queue.queue[b-1].id]=b;break}}}}l+=a.Config.appsPerRow}e=0;l-=a.Config.appsPerRow;while(l>m){if(a.Queue.queue[l-1]){if(h[a.Queue.queue[l-1].id]){h[a.Queue.queue[l-1].id]+=e*a.Config.appsPerRow}a.Queue.switchQueue(l,l+e*a.Config.appsPerRow)}else{e++}l-=a.Config.appsPerRow}}e=0}for(var g in h){if(typeof h[g]=="number"&&h[g]!=m){a.App.Yield.down(h[g],{width:2,height:2})}}}});a.App.Drag=a.extend(a.App.Drag,{from:false,to:false,editMode:false,activeEdit:false,dragStart:function(c){var b=c.target;a.Page.rowIndexMem=a.Page.currentRowIndex;while(b.parentNode){if(b.parentNode.id=="iconsContainer"||b.className=="icon"){break}else{b=b.parentNode}}if(/[A-z0-9]+\./ig.test(b.id)){b.style.webkitTransform="scale(1.2)";b.style.zIndex="9";if(!a.App.editMode){a.App.activeEdit=true}else{a.App.activeEdit=false}a.App.target=b}else{if(b.nodeType==1&&b.getAttribute("iWidget")){if(!a.App.editMode){a.App.activeEdit=true}else{a.App.activeEdit=false}a.App.target=b}else{a.App.target=null}}if(a.App.activeEdit){a.App.Drag.openEditMode();setTimeout(function(){a.Browser.vibrate(60)},0)}if(a.App.target){a.App.Drag.bubbleDragEvent(c);a.App.from=a.App.Drag.findStartPos();a.Tray.isActionOut(b)}},dragMove:function(f){if(!a.App.editMode||!a.App.target){return}var d=a.Drive.Var.endX=f.touches[0].pageX;var c=a.Drive.Var.endY=f.touches[0].pageY;var i=a.App.iconHeight;var h=a.App.iconWidth;var g=Math.round(c/i+0.4);var b=Math.round(d/h+0.4);if(a.Config.isVertical){if(a.Tray.Var.actionOut){a.App.target.style.left=(d-h/2)+"px";a.App.target.style.top=(c-i/2)-i*a.Config.appsPerColumn+"px"}else{a.App.target.style.left=(d-h/2)+"px";a.App.target.style.top=(c-i/2)+a.Page.currentRowIndex*i+"px";if(a.Tray.Var.targetMem){a.Tray.Var.targetMem.style.left=(d-h/2)+"px";a.Tray.Var.targetMem.style.top=(c-i/2)-i*a.Config.appsPerColumn+"px"}}}if(a.Config.isVertical){if(c>i*3.5&&c<i*4){clearTimeout(a.App.timeout);a.App.timeout=setTimeout(function(){if(a.Page.currentRowIndex+1<a.Page.pagesCount*a.Config.appsPerColumn){a.Page.slideToPage(1,100)}},1000)}else{if(c<i*0.2){clearTimeout(a.App.timeout);a.App.timeout=setTimeout(function(){if(a.Page.currentRowIndex>0){a.Page.slideToPage(-1,100)}},1000)}else{if(c>=i*4){clearTimeout(a.App.timeout);if((!a.Tray.Var.actionOut)&&(!a.Tray.Var.actionIn)){a.Tray.moveInTray()}}else{clearTimeout(a.App.timeout);g=g||1;if(g>4){a.App.to=false}else{g+=a.Page.currentRowIndex;a.App.to=(g-1)*4+b}}}}}if(typeof a.App.to=="number"){a.Box.highlight(h);a.App.Drag.exchangeOnMove(c)}else{a.Box.highlight(false)}},dragEnd:function(c){clearTimeout(a.App.timeout);clearTimeout(a.App.timeout2);if(!a.App.editMode||!a.App.target){return}else{a.App.target.style.webkitTransform="";a.Box.highlight(false)}if(a.Tray.Var.actionIn){a.Tray.endToIn(a.Drive.Var.endY)}else{if(a.Tray.Var.actionOut){if(!a.Queue.queue[a.App.to-1]){a.Tray.moveOutTray()}a.Tray.endToOut((!a.Queue.queue[a.App.to-1])&&(typeof a.App.to=="number"))}else{var d=a.App.from;if(typeof(a.App.to)=="number"){var b=a.App.to-1;if(a.Page.rowIndexMem==a.Page.currentRowIndex||(!a.Queue.queue[b])){a.App.Drag.doSwitch()}else{a.App.target.style.left=((d-1)%a.Config.appsPerRow)*(100/a.Config.appsPerRow)+"%";a.App.target.style.top=Math.floor((d-1)/a.Config.appsPerColumn)*100/(a.Page.pagesCount*a.Config.appsPerColumn)+"%"}if(a.App.target.getAttribute("iWidget")){a.App.target.style.zIndex=""}}else{a.App.target.style.left=((d-1)%a.Config.appsPerRow)*(100/a.Config.appsPerRow)+"%";a.App.target.style.top=Math.floor((d-1)/a.Config.appsPerColumn)*100/(a.Page.pagesCount*a.Config.appsPerColumn)+"%"}}}a.App.to=false;a.App.from=false;a.App.toMem=false},findStartPos:function(){for(var b=0;b<a.Queue.queue.length;b++){if(a.Queue.queue[b]&&(a.Queue.queue[b].id===a.App.target.id||a.Queue.queue[b].id===a.App.target.getAttribute("iWidget"))){return(b+1)}}},exchangeOnMove:function(b){clearTimeout(a.App.timeout2);a.App.timeout2=setTimeout(function(){if(!a.Tray.Var.actionOut&&a.Page.rowIndexMem==a.Page.currentRowIndex&&b<a.App.iconHeight*4){a.App.Drag.doSwitch()}},300)},doSwitch:function(){if(a.App.target.getAttribute("iWidget")){if(a.Widget.moveWidget(a.App.from,a.App.to)){}a.App.from=a.App.to}else{if(a.Widget.isWidget(a.App.to)){a.Queue.backToFrom(a.App.from)}else{a.Queue.switchQueue(a.App.from,a.App.to);a.App.from=a.App.to}}},bubbleDragEvent:function(c){var b=document.createEvent("Events");b.initEvent("drag",true,true);c.target.dispatchEvent(b)},openEditMode:function(){var d=a.Tray.tray.getElementsByClassName("icon");for(var b=0;b<a.Queue.queue.length;b++){if(a.Queue.queue[b]){a.Queue.queue[b].firstChild.style.display="block";if(a.Queue.queue[b].getAttribute("hasWidget")){a.Queue.queue[b].lastChild.style.display="block"}}}for(var b in a.Widget.widgets){a.Widget.widgets[b].widget.lastChild.style.display="block"}for(var c=0;c<d.length;c++){d[c].firstChild.style.display="block"}a.App.editMode=true},closeEditMode:function(){var d=a.Tray.tray.getElementsByClassName("icon");for(var b=0;b<a.Queue.queue.length;b++){if(a.Queue.queue[b]){a.Queue.queue[b].firstChild.style.display="none";if(a.Queue.queue[b].getAttribute("hasWidget")){a.Queue.queue[b].lastChild.style.display="none"}}}for(var b in a.Widget.widgets){a.Widget.widgets[b].widget.lastChild.style.display="none"}for(var c=0;c<d.length;c++){d[c].firstChild.style.display="none";d[c].lastChild.style.display="none"}a.App.editMode=false;a.App.activeEdit=false}});_Base_=a}(_Base_);!function(a){a.Box=a.extend(a.Box,{highlightBox:null,highlight:function(d){var c=a.App.to-1,b;if(!a.Box.highlightBox&&d>1){var e=document.createElement("div");e.style.height=d*0.66+"px";e.style.width=d*0.66+"px";e.style.marginTop=d/4+"px";e.style.marginLeft=d/6+"px";e.style.position="absolute";e.style.display="none";a.container.appendChild(e);a.Box.highlightBox=e}else{if(d!==false){a.Box.highlightBox.style.display="block";a.Box.highlightBox.style.left=(c%a.Config.appsPerRow)*(100/a.Config.appsPerRow)+"%";a.Box.highlightBox.style.top=Math.floor(c/a.Config.appsPerColumn)*100/(a.Page.pagesCount*a.Config.appsPerColumn)+"%";if(a.Tray.Var.actionOut||a.Page.rowIndexMem!=a.Page.currentRowIndex){if(a.Queue.queue[c]){a.Box.highlightBox.style.webkitBoxShadow="0 0 5px 2px red"}else{a.Box.highlightBox.style.webkitBoxShadow="0 0 5px 2px green"}}else{a.Box.highlightBox.style.webkitBoxShadow="0 0 5px 2px green"}}else{if(a.Box.highlightBox){a.Box.highlightBox.style.display="none"}return"closed"}}}});_Base_=a}(_Base_);!function(a){a.Browser=a.extend(a.Browser,{regListener:function(b){window.nativeapps.setWebUpdateContentCallback(b)},getDefaultIconUri:function(){return window.nativeapps.getDefaultAppIconUri()},launchApp:function(d){var e=d.split("/");var c=e[0];var b=e[1];window.nativeapps.launchActivity(c,b)},hardkey:function(b){window.nativeapps.setWebKeyEventCallback(b)},vibrate:function(b){window.nativeapps.vibrate(b)}});_Base_=a}(_Base_);!function(a){window.debug=a.Debug=a.extend(a.Debug,{log:function(){try{var c=a.Debug.stringify.apply(a.Debug,arguments).slice(0,-1);console.log(c);return c}catch(b){console.log(b)}},stringify:function(){var e="";for(var c=0;c<arguments.length;c++){var d=toString.call(arguments[c]);if(d.indexOf("Object")!=-1){e+="{";for(var b in arguments[c]){e+=b+":"+a.Debug.stringify(arguments[c][b])}if(e[e.length-1]!="{"){e=e.substr(0,e.length-1)}e+="},"}else{if(d.indexOf("Array")!=-1){e+="[";for(var f=0;f<arguments[c].length;f++){e+=a.Debug.stringify(arguments[c][f])}if(e[e.length-1]!="["){e=e.substr(0,e.length-1)}e+="],"}else{e+=arguments[c]+","}}}return e}});_Base_=a}(_Base_);!function(a){var b=/(\w+)?[#.]?(\w+)*/;a.DOM=function(c,d){return new a.DOM.select(c,d)};a.DOM.select=function(){var e=[];var c=arguments[0],g=arguments[1]||window.document;if(g.nodeType!==1&&g.nodeType!==9){g=window.document}if(!c){return this}if(typeof c==="object"&&c.nodeType===1){this.selector=c;return this}if(typeof c==="string"){var j=c.trim().split(" ");for(var f=0;f<j.length;f++){var d=b.exec(j[f]);if(d){if(d[2]){if(d[0].indexOf("#")!=-1){var h=document.getElementById(d[2]);if(!d[1]){e.push(h)}else{if(h.nodeName===d[1].toUpperCase()){e.push(h)}}}else{h=Array.prototype.slice.call(g.getElementsByClassName(d[2]));if(!d[1]){e=e.concat(h)}else{for(var f=0;f<h.length;f++){if(h[f].nodeName===d[1].toUpperCase()){e.push(h[f])}}}}}else{e=e.concat(Array.prototype.slice.call(g.getElementsByTagName(d[1])))}}}this.selector=e;return this}};a.DOM.select.prototype=a.DOM;a.DOM=a.extend(a.DOM,{removeAllChild:function(d){this.selector=this.selector||[];d=this.selector.concat(d);for(var c=0;c<d.length;c++){if(typeof d[c]=="object"&&d[c].nodeType==1){while(d[c].firstChild){d[c].removeChild(d[c].firstChild)}}}},listen:function(f,h,c,g){try{this.selector=this.selector||[];g=this.selector.concat(g);for(var e=0;e<g.length;e++){if(typeof g[e]=="object"&&g[e].nodeType==1&&["click","dbclick","swipe","longtap","drag","pinch","touchstart","touchmove","touchend","touchcancel"].indexOf(f)!=-1){g[e].addEventListener(f,h,c)}else{throw"wrong arguments, or event is not supported."}}}catch(d){console.log(d)}},fire:function(f,d){this.selector=this.selector||[];d=this.selector.concat(d);for(var c=0;c<d.length;c++){if(typeof d[c]=="object"&&d[c].nodeType==1){var g=document.createEvent("Events");g.initEvent(f,true,true);g.target=d[c];d[c].dispatchEvent(g)}}}});_Base_=a}(_Base_);!function(a){a.Drive=a.Drive||{};a.Drive.Var=a.Drive.Var||{};a.Drive=a.extend(a.Drive,{Var:{startX:0,startY:0,pinchStartLen:0,pinchEndLen:0,longTapIndex:-1,lastClickTime:0,clickIndex:-1,movedDistance:0,moveStartX:0,moveStartY:0,nextToEndX:0,nextToEndY:0,endX:0,endY:0,lastMoveTime:undefined},touchstart:function(d){a.App.getSize();a.Sidebar.sideBar(true);a.Drive.Var.pinchEndLen=0;if(d.touches.length===1){a.Drive.Var.startX=d.touches[0].pageX;a.Drive.Var.startY=d.touches[0].pageY;if(a.App.editMode){a.App.Drag.dragStart(d)}a.Drive.Var.longTapIndex=setTimeout(function(){var e=document.createEvent("Events");e.initEvent("longtap",true,true);d.target.dispatchEvent(e);if(!a.App.editMode){a.App.Drag.dragStart(d)}a.Sidebar.sideBar(false)},1000)}else{if(d.touches.length===2){clearTimeout(a.Drive.Var.longTapIndex);var c=d.touches[1].pageX-d.touches[0].pageX;var b=d.touches[1].pageY-d.touches[0].pageY;a.Drive.Var.pinchStartLen=Math.sqrt(c*c+b*b)}}},touchmove:function(c){var k=a.Drive.Var;c.preventDefault();k.lastMoveTime=new Date;clearTimeout(k.longTapIndex);if(!a.App.editMode){if(c.touches.length==1){k.nextToEndX=k.endX;k.nextToEndY=k.endY;var l=k.endX=c.touches[0].pageX;var j=k.endY=c.touches[0].pageY;if(a.Config.isVertical){var f=k.startY-j+k.moveStartY;var i=document.getElementById("appScreen").clientHeight*(a.Page.pagesCount-1);if(f>i){f=i}else{if(f<0){f=0}}var d={x:0,y:f};k.movedDistance=j-k.startY}else{var g=l-k.startX+k.moveStartX;var h=document.getElementById("appScreen").clientWidth*(a.Page.pagesCount-1)*-1;if(g>0){g=0}else{if(g<h){g=h}}d={x:g,y:0};k.movedDistance=l-k.startX}a.Sidebar.moveSidebar(a.Sidebar.sidebar,d);a.Page.moveBG(a.Config.isBGMovable,d);a.Page.css3move(a.container,d)}else{if(c.touches.length==2){if(!k.pinchEndLen){k.pinchEndLen=Math.sqrt((c.touches[1].pageX-c.touches[0].pageX)*(c.touches[1].pageX-c.touches[0].pageX)+(c.touches[1].pageY-c.touches[0].pageY)*(c.touches[1].pageY-c.touches[0].pageY));var b=document.createEvent("Events");b.initEvent("pinch",true,true);b.scale=k.pinchEndLen/k.pinchStartLen;c.target.dispatchEvent(b)}}}}else{var j=c.touches[0].pageY;var f=k.startY-j+k.moveStartY;a.Sidebar.moveSidebar(a.Sidebar.sidebar,{x:0,y:f});a.Page.moveBG(a.Config.isBGMovable,{x:0,y:f});a.App.Drag.dragMove(c)}},touchend:function(j){var q=a.Drive.Var,f=a.Page.currentRowIndex;if(a.App.editMode){a.App.Drag.dragEnd(j);var m=f*a.App.iconHeight;a.Sidebar.moveSidebar(a.Sidebar.sidebar,{x:0,y:m});a.Page.moveBG(a.Config.isBGMovable,{x:0,y:m})}else{clearTimeout(q.longTapIndex);var o=q.endX-q.nextToEndX;var d=q.endY-q.nextToEndY;var b=(new Date-q.lastMoveTime);var k=Math.sqrt(o*o+d*d)/b;if(q.endX){if(Math.abs(q.endX-q.startX)>Math.abs(q.endY-q.startY)){if(q.endX>q.startX){var n="right"}else{n="left"}}else{if(q.endY>q.startY){var n="down"}else{n="up"}}var c=document.createEvent("Events");c.initEvent("swipe",true,true);c.data={};c.data.direction=n;c.data.endSpeed=k;j.target.dispatchEvent(c);q.endX=0}if(a.Config.isVertical){var i=q.movedDistance/(a.App.iconHeight*a.Config.appsPerColumn);var l=(a.Page.pagesCount-1)*a.Config.appsPerColumn;if(k>0.3){if(i>0){f-=a.Config.appsPerColumn;f=f>0?f:0}else{if(i<0){f+=a.Config.appsPerColumn;f=f<l?f:l}}}else{var p=Math.round(i*a.Config.appsPerColumn);f-=p;if(f<0){f=0}else{if(f>l){f=l}}}var m=f*a.App.iconHeight;q.moveStartY=m;a.Page.currentRowIndex=f;var g={x:0,y:m}}a.Sidebar.moveSidebar(a.Sidebar.sidebar,g);a.Page.css3move(a.container,g,100);a.Page.moveBG(a.Config.isBGMovable,g);a.Sidebar.sideBar(false);q.movedDistance=0}},touchcancel:function(b){a.Drive.touchend(b)},click:function(f){var g=a.Drive.Var;var b=new Date;var d=f.target;if(!a.App.editMode){if(b-g.lastClickTime<400){clearTimeout(g.clickIndex);var c=document.createEvent("Events");c.initEvent("dbclick",true,true);f.target.dispatchEvent(c)}else{g.clickIndex=setTimeout(function(){while(!d.id&&d.id!="iconsContainer"){d=d.parentNode}if(/[A-z0-9]+\./ig.test(d.id)&&f.target.nodeName=="IMG"){a.Browser.launchApp(d.id);console.log(d.id);a.Sound.playAudio(0)}},400)}}g.lastClickTime=b}});_Base_=a}(_Base_);!function(a){a.Helper=a.extend(a.Helper,{toNum:function(c){var b=parseFloat(c);if(isNaN(b)){b=0}return b}});_Base_=a}(_Base_);!function(a){a.Notify=a.extend(a.Notify,{notify:function(){}});_Base_=a}(_Base_);!function(a){a.Page=a.extend(a.Page,{pagesCount:0,currentRowIndex:0,slideToPage:function(h,g){var f=a.Config.appsPerColumn,e=a.Page.pagesCount,c=a.Page.currentRowIndex;var d=h*f;c+=d;var b=(e-1)*f;if(c<0){c=0}else{if(c>b){c=b}}if(a.Config.isVertical){var i=c*a.App.iconHeight;a.Page.css3move(a.container,{x:0,y:i},g);a.Drive.Var.moveStartY=i;a.Page.currentRowIndex=c}a.Page.moveBG(a.Config.isBGMovable,{x:0,y:i})},css3move:function(b,d,c){c=c||0;b.style.webkitTransform="translate3d("+d.x+"px, -"+d.y+"px,0)";b.style.webkitTransitionDuration=c+"ms";b.style.webkitBackfaceVisiblity="hidden";b.style.webkitTransformStyle="preserve-3d";b.style.webkitTransitionTimingFunction="cubic-bezier(0.33,0.66,0.66,1)"},addPage:function(b){b=b||1;a.Page.pagesCount+=b;a.Page.pagesCount=a.Page.pagesCount||1;a.System.refresh()},moveBG:function(b,c){if(b&&typeof c.y=="number"){document.body.style.backgroundPosition="0 "+(c.y*100/document.getElementById("iconsContainer").clientHeight)+"%"}}});_Base_=a}(_Base_);!function(e){var d=e.App,a=e.Drive,c=e.Tray,b=e.Box;e.Queue=e.extend(e.Queue,{queue:[],switchQueue:function(j,i){var g=j-1,f=i-1;if(e.Queue.queue[g]){e.Queue.queue[g].style.left=(f%e.Config.appsPerRow)*(100/e.Config.appsPerRow)+"%";e.Queue.queue[g].style.top=Math.floor(f/e.Config.appsPerColumn)*100/(e.Page.pagesCount*e.Config.appsPerColumn)+"%";e.Widget.locateWidget(e.Queue.queue[g].id,e.Queue.queue[g].style.top,e.Queue.queue[g].style.left)}if(j!=i){if(e.Queue.queue[f]){e.Queue.queue[f].style.left=(g%e.Config.appsPerRow)*(100/e.Config.appsPerRow)+"%";e.Queue.queue[f].style.top=Math.floor(g/e.Config.appsPerColumn)*100/(e.Page.pagesCount*e.Config.appsPerColumn)+"%";e.Widget.locateWidget(e.Queue.queue[f].id,e.Queue.queue[f].style.top,e.Queue.queue[f].style.left)}var h=e.Queue.queue[f];e.Queue.queue[f]=e.Queue.queue[g];e.Queue.queue[g]=h}},backToFrom:function(g){var f=g-1;if(e.Queue.queue[f]){e.Queue.queue[f].style.left=(f%e.Config.appsPerRow)*(100/e.Config.appsPerRow)+"%";e.Queue.queue[f].style.top=Math.floor(f/e.Config.appsPerColumn)*100/(e.Page.pagesCount*e.Config.appsPerColumn)+"%";e.Widget.locateWidget(e.Queue.queue[f].id,e.Queue.queue[f].style.top,e.Queue.queue[f].style.left)}},delQueue:function(f){e.Queue.queue[f-1]=undefined}});_Base_=e}(_Base_);!function(a){a.Sidebar=a.extend(a.Sidebar,{sidebar:null,sideBar:function(b){if(!a.Sidebar.sidebar&&b){var c=document.createElement("div");c.style.position="absolute";var d=document.getElementById("appScreen");if(a.Config.isVertical){c.style.right="1px";c.style.width="4px";c.style.height=(d.clientHeight/a.Page.pagesCount)+"px"}else{c.style.bottom="1px";c.style.height="4px";c.style.width=(d.clientWidth/a.Page.pagesCount)+"px"}c.style.backgroundColor="black";c.style.opacity="0.4";c.style.borderRadius="3px";c.style.zIndex="99";d.appendChild(c);a.Sidebar.sidebar=c}else{if(a.Sidebar.sidebar&&b){a.Sidebar.sidebar.style.display="block"}else{setTimeout(function(){a.Sidebar.sidebar.style.display="none"},1000)}}},moveSidebar:function(d,b){if(d&&typeof b.y=="number"){var e=b.y;var c=document.getElementById("iconsContainer").clientHeight;d.style.top=100*e/c+"%"}}});_Base_=a}(_Base_);!function(a){a.Sound=a.extend(a.Sound,{audio:[],loadAudio:function(c){var b=new Audio(c);b.preload="auto";this.audio.push(b)},playAudio:function(b){this.audio[b].play()},pauseAudio:function(b){this.audio[b].pause()},volumeup:function(b){this.audio[b].volume+=0.1},volumedown:function(b){this.audio[b].volume-=0.1}});_Base_=a}(_Base_);var spriteMovie=(function(){function a(b,d,c){this.imgSrc=b;this.flashWindow=d;this.movieArray=c;this.loadImage(b)}a.prototype={isImageLoad:false,isbgset:false,loadImage:function(c,e){var b=new Image();b.src=c;var d=this;b.onload=function(){console.log("image load completed!");d.isImageLoad=true;if(e&&typeof e=="function"){e()}var f=document.getElementById("notice");if(f){f.innerHTML="Load completed!"}}},setFlashWindow:function(d,f,c){d.el.style.width=d.width+"px";d.el.style.height=d.height+"px";var e=this;var b=setInterval(function(){if(e.isImageLoad){d.el.style.background="url("+e.imgSrc+") top left no-repeat";d.el.style.backgroundPosition="-"+f[c].left+"px -"+f[c].top+"px";e.isbgset=true;if(e.wantPlayFps){e.play(e.wantPlayFps);e.wantPlayFps=0}else{if(e.wantRewindFps){e.rewind(e.wantRewindFps);e.wantRewindFps=0}}clearInterval(b)}},10)},play:function(d){this.setFlashWindow(this.flashWindow,this.movieArray,0);d=d||16;var c=1000/d;this.wantPlayFps=d;if(this.isbgset){this.wantPlayFps=0;var b=this;this.frame=this.frame||0;clearInterval(this.start);this.start=setInterval(function(){b.flashWindow.el.style.backgroundPosition="-"+b.movieArray[b.frame].left+"px -"+b.movieArray[b.frame].top+"px";b.frame==(b.movieArray.length-1)?(b.frame=0,b.stop()):(b.frame++)},c)}},stop:function(){if(this.start){clearInterval(this.start);this.frame=0}},pause:function(){if(this.start){clearInterval(this.start)}},rewind:function(d){this.setFlashWindow(this.flashWindow,this.movieArray,this.movieArray.length-1);d=d||16;var c=1000/d;this.wantRewindFps=d;if(this.isbgset){this.wantRewindFps=0;var b=this;var e=(this.movieArray.length-1);clearInterval(this.start);this.start=setInterval(function(){b.flashWindow.el.style.backgroundPosition="-"+b.movieArray[e].left+"px -"+b.movieArray[e].top+"px";if(e==0){if(b.callback){console.log("call back");b.callback()}clearInterval(b.start)}else{e--}},c)}}};return a})();!function(base){base.System=base.extend(base.System,{init:function(container){if(typeof container=="string"){base.container=document.getElementById(container)}else{if(typeof container=="object"&&container.nodeType==1){base.container=container}}document.body.addEventListener("touchstart",function(e){base.Drive.touchstart(e)},false);document.body.addEventListener("touchmove",function(e){base.Drive.touchmove(e)},false);document.body.addEventListener("touchend",function(e){base.Drive.touchend(e)},false);document.body.addEventListener("touchcancel",function(e){base.Drive.touchcancel(e)},false);document.body.addEventListener("click",function(e){base.Drive.click(e)},false);base.Tray.addFixedArea();base.Sound.loadAudio("./mp3.mp3")},run:function(container,config){base(config);base.System.init(container);window.loadRes=base.System.loadRes;base.Browser.regListener("loadRes");window.hardkeyListener=base.System.hardkeyListener;base.Browser.hardkey("hardkeyListener");base.System.showVersion()},loadRes:function(appListJson,lastBatch){var apps,defaultUri=base.Browser.getDefaultIconUri();apps=eval(appListJson);var len=apps.length;var icon,label;for(var i=0;i<apps.length;i++){var icon=defaultUri;if(apps[i].iconUri!=null){icon=apps[i].iconUri}label=apps[i].label||"LOADING";switch(apps[i].appPackage+"/"+apps[i].appClass){case"com.lge.app.richnote/com.lge.app.richnote.RichNoteList":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/todo.js"});break;case"com.lge.music/com.lge.music.MusicBrowserActivity":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/music.js"});break;case"com.android.mms/com.android.mms.ui.ConversationList":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/message.js"});break;case"com.android.cellbroadcastreceiver/com.android.cellbroadcastreceiver.CellBroadcastListActivity":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/weather.js"});break;case"com.android.gallery3d/com.android.gallery3d.app.Gallery":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/photo.js"});break;case"com.android.settings/com.android.settings.Settings":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/settings.js"});break;case"com.lge.clock/com.lge.clock.AlarmClockActivity":base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:"./widget/clock.js"});break;default:base.App.register({title:label,packageName:apps[i].appPackage+"/"+apps[i].appClass,imgSrc:icon,widget:""})}}if(lastBatch==="true"||lastBatch===true){base.System.display();base.System.refresh()}},display:function(){var appNode;var appsCount=base.App.appsCount;base.Page.pagesCount=Math.ceil(appsCount/(base.Config.appsPerRow*base.Config.appsPerColumn));for(var i=0;i<appsCount;i++){appNode=base.Queue.queue[i];base.container.appendChild(appNode)}},refresh:function(){var container=base.container,pagesCount=base.Page.pagesCount,appsPerRow=base.Config.appsPerRow,appsPerColumn=base.Config.appsPerColumn;var icons=base.Queue.queue;if(base.Config.isVertical){container.style.height=100*pagesCount+"%";for(var i=0;i<icons.length;i++){base.App.resizeApp(icons[i],i)}}base.Widget.refresh()},version:"2.1.6 beta",showVersion:function(){base.Debug.log("Version: "+base.System.version);return base.System.version},hardkeyListener:function(keycode){if(keycode==4){base.App.Drag.closeEditMode()}else{if(keycode==3){}else{}}}});_Base_=base}(_Base_);window.addEventListener("load",function(){_Base_.System.run("iconsContainer",{isVertical:true,appsPerRow:4,appsPerColumn:4})},false);function updateContent(){}window.addEventListener("gestureend",function(){console.log("getsteure")},false);window.addEventListener("swipe",function(a){},false);window.addEventListener("pinch",function(a){if(a.scale>1){console.log("pinch to larger")}else{console.log("pinch to smaller")}},false);!function(c){var a=c.Drive,b=c.Box;c.Tray=c.extend(c.Tray,{tray:null,Var:{targetMem:null,actionIn:false,actionOut:false},addFixedArea:function(){var d=document.createElement("div");d.style.width="100%";d.style.height="16%";d.style.zIndex="31";d.style.position="absolute";d.style.bottom="0";d.style.left="0";d.style.backgroundColor="black";d.style.opacity="0.6";d.style.borderTop="1px solid #F0FFF0";d.id="tray";c.Tray.tray=d;document.body.appendChild(d)},moveInTray:function(){var d=c.App.target.cloneNode(true);d.style.top="0";d.style.height="100%";d.style.width="20%";c.Tray.tray.appendChild(d);c.App.target.style.display="none";c.Tray.Var.actionIn=true;c.Tray.Var.targetMem=d;if(c.Tray.checkFull()){c.App.to=c.App.from}},endToIn:function(d){if(d>=c.App.iconHeight*4&&(!c.Tray.checkFull())){c.Queue.delQueue(c.App.from);c.container.removeChild(c.App.target);c.App.target=c.Tray.Var.targetMem;c.App.target.lastChild.style.display="none"}else{c.Queue.switchQueue(c.App.from,c.App.to);c.Tray.tray.removeChild(c.Tray.Var.targetMem);c.App.target.style.display="block"}c.Tray.Var.targetMem=null;c.Tray.Var.actionIn=false;c.Tray.arrange()},checkFull:function(){var d=c.Tray.tray.getElementsByClassName("icon");if(d.length<5){return false}else{return true}},arrange:function(){var f=c.Tray.tray.getElementsByClassName("icon");var d=f.length;var g=(100-25*d)/(d+1);for(var e=0;e<d;e++){f[e].style.webkitTransform="";f[e].style.top="0";f[e].style.height="100%";f[e].style.left=(g+25)*e+g+"%"}},moveOutTray:function(){var d=c.App.target.cloneNode(true);c.container.appendChild(d);c.Tray.Var.targetMem=d},endToOut:function(d){if(typeof d=="boolean"&&d){var e=c.App.to-1;c.Tray.tray.removeChild(c.App.target);c.App.target=c.Tray.Var.targetMem;c.Queue.queue[e]=c.App.target;c.App.resizeApp(c.App.target,e);if(c.App.target.getAttribute("hasWidget")){c.App.target.lastChild.style.display="block"}}else{if(c.Tray.Var.targetMem){c.container.removeChild(c.Tray.Var.targetMem)}}c.Tray.Var.targetMem=null;c.Tray.arrange();c.Tray.Var.actionOut=false;c.Tray.restoreEvent()},isActionOut:function(e){try{if(e.parentNode&&e.parentNode.id=="tray"){c.Tray.Var.actionOut=true}else{c.Tray.Var.actionOut=false}}catch(d){c.Debug.log(d)}},restoreEvent:function(){var e=c.App.target.id;var f=c.Widget.widgets[e];if(f){var d=document.getElementById(f.open.node);var g=document.getElementById(f.close.node);f.widget.style.top=c.App.target.style.top;f.widget.style.left=c.App.target.style.left;c.Widget.attachEvent(e,d,g,f)}}});_Base_=c}(_Base_);!function(f){var b=f.Config,e=f.Page,a=f.Drive,d=f.Tray,c=f.Box;f.Widget=f.extend(f.Widget,{widgets:{},removeWidget:function(j){var g=document.getElementsByTagName("script");for(var h=0;h<g.length;h++){if(g[h].src==j){g[h].parentNode.removeChild(g[h]);return true}}return false},registerWidget:function(j){for(var g in j){f.Widget.widgets[g]=j[g];try{if(typeof j[g].widget=="string"){f.Widget.widgets[g].widget=document.getElementById(j[g].widget)}else{if(typeof j[g].widget=="object"&&j[g].widget.nodeType==1){f.Widget.widgets[g].widget=j[g].widget}else{throw"wrong widget type, it should be DOM node or elemetn ID"}}}catch(h){console.log(h)}f.Widget.initWidget(g,j[g])}},initWidget:function(h,j){if(typeof j.open.node=="string"){f.Widget.widgets[h].open.node=j.open.node;var g=document.getElementById(j.open.node)}else{if(typeof j.open.node=="object"&&j.open.node.nodeType==1){f.Widget.widgets[h].open.node=j.open.node.id;g=j.open.node}}if(typeof j.close.node=="string"){f.Widget.widgets[h].close.node=j.close.node;var i=document.getElementById(j.close.node)}else{if(typeof j.close.node=="object"&&j.close.node.nodeType==1){f.Widget.widgets[h].close.node=j.close.node.id;var i=j.close.node}}f.Widget.attachEvent(h,g,i,j)},locateWidget:function(j,i,h){if(f.Widget.widgets[j]){var g=f.Widget.widgets[j].widget;g.style.left=h;g.style.top=i}},moveWidget:function(o,p){if(p%f.Config.appsPerRow==0||o==p){f.Queue.switchQueue(o,o);return false}var m=[];var q=[];var h;var n,g;for(var l=0;l<2;l++){for(var k=0;k<2;k++){h=l*4+k;m.push(o+h);q.push(p+h);g=f.Widget.isWidget(p+h);if(g&&f.Queue.queue[g-1].id!=f.App.target.getAttribute("iWidget")){f.Queue.backToFrom(o);return false}}}for(var l=0;l<m.length;l++){for(var k=0;k<q.length;k++){if(m[l]==q[k]){q[k]=undefined;m[l]=undefined}}}for(var l=0;l<m.length;l++){for(var k=0;k<q.length;k++){if(m[l]&&q[k]){f.Queue.switchQueue(m[l],q[k]);if(l==0){n=q[k]}m[l]=undefined;q[k]=undefined}}}n=n||o;f.Debug.log("from",o,"to",p,"pos",n);f.Queue.switchQueue(n,p);return true},isWidget:function(l){var i;for(var g=0;g<2;g++){for(var h=0;h<2;h++){i=l-h-g*f.Config.appsPerRow;if(f.Queue.queue[i-1]&&f.Widget.widgets[f.Queue.queue[i-1].id]&&f.Widget.widgets[f.Queue.queue[i-1].id].widget.style.display=="block"){return i}}}return false},attachEvent:function(i,h,j,k){var g=-1;h.lastChild.addEventListener("click",function(o){for(var n=0;n<f.Queue.queue.length;n++){if(f.Queue.queue[n]&&f.Queue.queue[n].id===i){g=n+1;break}}f.Widget.widgets[i].widget.style.top=h.style.top;f.Widget.widgets[i].widget.style.left=h.style.left;f.Widget.widgets[i].widget.style.height=45/_Base_.Page.pagesCount+"%";try{var l=f.App.Yield(g,f.Widget.widgets[i].size,"right");if(l===false){f.App.shake(h);console.log("No available space.")}else{k.open.func(o);h.style.display="none";j.style.display="block"}}catch(m){console.log(m)}},false);j.lastChild.addEventListener("click",function(m){h.style.top=f.Widget.widgets[i].widget.style.top;h.style.left=f.Widget.widgets[i].widget.style.left;try{k.close.func(m);j.style.display="none";h.style.display="block"}catch(l){console.log(l)}},false)},refresh:function(){for(var g in f.Widget.widgets){f.Widget.widgets[g].widget.style.height=45/_Base_.Page.pagesCount+"%";f.Widget.widgets[g].widget.style.top=f.Helper.toNum(f.Widget.widgets[g].widget.style.top)*(f.Page.pagesCount-1)/f.Page.pagesCount+"%"}}});_Base_=f}(_Base_);